# 라우터를 통한 네트워크 보안

## 콘솔, AUX, VTY 포트 패스워드 보안
* 콘솔 포트는 케이블을 이용해 직접 터미널에 연결하여 라우터를 조작할 수 있도록 하며 장애 처리 시 많이 사용된다. 
* 패스워드를 설정하지 않은 콘솔 포트에 접속하게 되면 일반적으로 아무런 인증 정차 없이 라우터 설정을 조회할 수 있다. 
* 따라서 여러 사람이 콘솔을 사용하여 라우터에 접근할 가능성이 있는 경우에는 콘솔 패스워드를 반드시 설정해야한다. 
    ```
    > enable
    # conf t
    (config) # line console 0
    (config-line) # login
    (config-line) # password cisco
    (config-line) # end
    #

    ```
* VTY 포트는 원격지에서 텔넷을 통하여 접속 시 사용되는 패스워드를 설정한다. AUX 포트는 현재 잘 사용되지 않는 포트이며 VTY 포트 설정과 동일하다. 
    ```
    > enable
    # conf t
    (config) # line aux 0
    (config-line) # login
    (config-line) # password cisco
    (config-line) # end
    #

    ```  
    ```
    > enable
    # conf t
    (config) # line vty 0 4 
    (config-line) # login
    (config-line) # password cisco
    (config-line) # end
    #

    ```
    
## 텔넷 접근 제한
* 기본적으로 VTY 포트는 외부로부터 연결 시도를 모두 받아들인다. 이러한 특징을 악용하여 무한대의 공격 시도를 통하여 라우터를 공격할 수 있다. 
* 따라서 라우터로 들어오는 패킷의 IP 주소를 차단하여 허가된 IP를 가진 사용자에게만 연결시도를 허용하는 것이 안전하다. 

    ```
    > enable
    # conf t
    (config) # access-list 10 permit host 192.168.0.1
    (config) # access-list 10 permit host 192.168.1.1
    (config) # access-list 10 deny any
    (config) # line vty 0 4
    (config-line) # access-class 10 in
    (config-line) # end
    #
    ```
* SSH(Secure Shell)는 암호화 통신을 하고 텔넷은 평문 통신을 하므로 텔넷은 SSH에 비해 보안에 취약하여 SSH를 설정하여 사용할 것을 권장한다. 
    ```
    > enable
    # conf t
    (config) # hostname [router name]
    (config) # IP domain-name [domain name]
    (config) # crypto key generate rsa
    (config) # IP ssh time-out [time out value]
    (config) # IP ssh authentication-retries [retries value]
    (config) # line vty 0 4
    (config-line) # transport input ssh
    (config-line) # end
    #
    ```

## SNMP 설정
* SNMP는 TCP/IP 네트워크를 모니터링하고 관리하기에 아주 효율적인 프로토콜이다. 대부분의 네트워크 장비들은 기본적으로 SNMP 서비스들을 포함하고 있어서 원격의 네트워크에 관련된 정보들을 수집할 수 있다. 
* 많은 시스템에서 SNMP의 읽기 권한은 기본적으로 설정되어있기에 이를 이용하려는 공격자들이 많다. 따라서 이를 위한 보안 설정이 필요하다. 
* 기본 community string 값은 public으로 SNMP를 지원하는 많은 장비에서 기본값을 변경해야 한다. 
* access-list를 이용하여 접근 통제를 하여야 하며 SNMP 정보 수신이 필요한 장비를 명시하여 허용하고 나머지는 차단하도록 한다. 
    ```
    > enable
    # conf t
    (config) # snmp-server community x27swf3 ro 11
    (config) # snmp-server contact ehdcjf@ehdcjf.com
    (config) # access-list 11 permit host 211.1.2.5
    (config) # access-list 11 deny any
    (config) # interface FastEthernet 0/0
    (config-line) # ip access-group 11 in
    (config-line) # end
    #show access-list
    ```

* SNMP 서비스를 사용하지 않는다면 서비스를 제거하는 것이 좋다. 
    ```
    > enable
    # conf t
    (config) # no snmp-server
    (config) # end
    #show access-list
    ```
* SNMP version 1, 2는 평문으로 정보를 전송하는 데 반대 SNMP version 3 는 암호화가 지원되므로 SNMP version 3의 지원 여부를 확인하여 사용하기를 권장한다. 

## 4 불필요한 서비스 제거
* 라우터는 네트워크 관리자의 편의를 위하여 기본 설정으로 여러 서비스들을 제공한다. 이러한 서비스들은 공격자에 의해서 네트워크의 정보를 얻거나 접근하는 수단으로 사용될 수 있다. 
* 따라서 불필요한 서비스는 보안에 위협 요소가 될 수 있으므로 모두 차단하는 것이 좋다. 

#### ICMP 