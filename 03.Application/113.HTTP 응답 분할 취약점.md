# HTTP 응답 분할(Response Splitting) 취약점
* 클라이언트 HTTP 요청에 포함된 요청 파라미터 값(입력값)이 HTTP 응답 헤더에 포함되어 클라이언트에게 다시 전달될 때, 파라미터 값에 개행문자인 CR(Carriage Return, %0D)과 LF(Line Feed, %0A)가 포함되어 있으면 HTTP 응답이 2개 이상으로 분리될 수 있다. 이 경우에 공격자가 개행문자를 이용하여 첫 번째 응답을 종료시키고 두 번째 응답에 악의적인 코드를 삽입하여 XSS 등의 공격을 수행할 수 있는 취약점을 말한다. 

## 동작 방식
1. 희생자는 공격자에 의해 cookieValue 파라미터가 조작된 링크 등을 클릭하여 요청 메시지를 웹서버에 전달한다.
	* 조작된 cookieValue 파라미터에는 개행문자(CR/LF)를 이용한 악의적인 두 번째 응답 메시지가 포함되어 있다. 
2. 요청을 처리하는 서버 스크립트는 요청 파라미터에 대한 검증 없이 이 값을 쿠키로 설정하여 응답 헤더에 담아 전달한다. 
3. 응답헤더 쿠키가 설정되면서 쿠키에 설정된 "Content-Length: 0" 헤더 이후의 개행문자(CR/LF) 연속 2개에 의해 응답 메시지가 두개로 분할 되어 처리된다. 
4. 두번째 응답에 있는 공격자의 스크립트가 실행된다. 


## 대응책
* 클라이언트 요청 파라미터(입력값)가 서버 프로그램에서 쿠키로 사용되거나, 리다이렉션을 위해 Location 응답헤더로 사용되거나 기타 응답헤더 설정에 사용될 경우 HTTP 응답이 분할이 발생하지 않도록 적절히 필터링(제거)하여 사용한다.  
→ 사용자 응답 보내기 전에 적절히 확인해서 응답 분할이 이루어지지 않도록 하기