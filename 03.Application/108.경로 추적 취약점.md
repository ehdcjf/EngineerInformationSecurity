# 경로 추적 취약점
* 웹 서버와 웹 애플리케이션 파일 또는 디렉터리 접근이 통제되지 않아 웹서버 또는 웹 애플리케이션의 주요한 파일과 데이터에 대한 접근 및 실행이 허용되는 취약점을 말한다. 
* 영문 표현시 Directory Traversal 취약점이라고도 한다. 한글 표현시 경로 조작, 경로 순회 취약점 이라고도 한다. 
* 웹 애플리케이션 루트 디렉터리를 벗어나 시스템의 주요 파일과 데이터에 접근할 수 있는 취약점을 말하며 일반적으로 경로를 조작하기 위해 상대경로 참조 방식을 사용한다. 
* 공격자는 요청 페이지에서 파라미터를 어떤 방식으로 디코딩하는지 알 수 없으므로 공격자는 가능한 모든 방식을 시도한다. 


* 주요 경로 조작 문자 및 인코딩 방식

__경로 조작 문자__
* ../  ..\

__URL 인코딩__
* .(%2e)  /(%2f) \\(%5c)

__더블 URL 인코딩__
* (%252e) /(%252f) \\(%255c)
* URL 인코딩된 문자열을 한번 더 인코딩 하여 % 문자가 %25로 인코딩됨
  
__16bit 유니코드 인코딩__
* .(%u002e) /(%u2215) \\(%u2216)


## 취약점 판단 기준
* 웹브라우저에서 표시할 페이지를 지정하는 요청 파라미터값을 임의의 경로가 포함된 값으로 변경하여 웹 루트 디렉터리보다 상위 디렉터리에 있는 파일에 접근할 수 있으면 취약한 것으로 판단한다. 


## 대응책
* 사용자가 임의로 접근할 수 있는 최상위 디렉터리를 웹 루트 디렉터리로 설정하여 웹 서버의 시스템 루트 디렉터리로 접근하지 못하도록 제한한다. 
  * 유닉스/리눅스 시스템의 경우 chroot 기능을 통해 웹 루트 디렉터리를 가상의 root 디렉터리로 만들어 시스템 루트 디렉터리에 대한 접근을 차단한다. 
  * 윈도우 시스템의 경우 새로운 논리드라이브(e.g E:\ )를 만들고 해당 드라이브를 웹 애플리케이션 루트 디렉터리로 설정한다. 

## `chroot`
* 유닉스/리눅스 시슽ㅁ에서 chroot는 Change Root Directory의 줄임말로 임시 루트 디렉터리를 설정하는 명령어 이다. 
* 시스템 루트 디렉터리를 `/`가 아닌 임의의 디렉터리 (e.g. /var/www/html)를 루트디렉터리로 설정하여 불필요한 루트 디렉터리 접근을 차단할 수 있다. 