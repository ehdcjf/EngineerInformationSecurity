# 파일 업로드 취약점
* 파일 업로드 기능이 존재하는 웹 애플리케이션에서 업로드에 대해 적절한 제어를 하지 않을 경우 허가되지 않은 파일들이 웹서버로 업로드될 수 있는 취약점을 말한다. 
* 업로드하는 파일타입이나 확장자를 체크하지 않고 업로드를 허용하는 경우 웹쉘이 업로드 되어 서버에서 악의적인 명령이 수행되거나 악성코드 파일이 업로드되어 이를 다운받은 사용자 PC가 침해사고를 당할 수 있다. 
* 웹쉘은 악의적인 목적으로 웹서버 내 임의의 명령을 실행할 수 있는 서버사이드 스크립트를 말하며 다양한 언어로 만들어진다. 웹쉘을 통해 시스템 명령 수행, 정보 획득, 소스 파일 변조 등 다양한 공격행위를 수행할 수 있다. 
* 업로드하는 파일의 개수나 크기에 제한을 두기 않을 경우 공격자는 다량의 아주 큰 파일을 연속적으로 전송하여 시스템 부하나 장애를 유발시킬 수 있다. 

## 취약점 판단기준
* 게시판, 자료실 등 파일 업로드가 가능한 입력 폼에 파일 업로드를 시도하여 업로드에 성공한 경우 취약한 것으로 판단한다. 

## 대응책
* 업로드 파일에 대한 파일타입 및 확장자 검증(화이트리스트 정책을 활용)을 통해 악성 스크립트 파일(웹쉘) 업로드를 차단한다. 
* 파일 타입은 요청메시지의 Content-Type 헤더를 변조할 수 있으므로 파일 확장자도 검증해야한다. 
* 업로드 파일을 저장하기 위한 전용 디렉터리를 별도 생성한 후 웹서버 설정을 통해 업로드 디렉터리에 있는 서버 사이드 스크립트 파일이 실행되지 않도록 설정하거나 직접 URL 호출을 차단하도록 설정한다. 
* 업로드하는 파일의 개수나 크기에 적절한 제한을 설정한다. 