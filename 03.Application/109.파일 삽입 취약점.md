# 파일 삽입 취약점
* 공격자가 악성 서버 스크립트를 서버에 전달하여 해당 페이지를 통해 악성코드가 실행되도록 하는 취약점을 말한다. 
* 삽입(include)할 악성 서버스크립트 파일의 위치가 로컬 서버에 위치하는지 원격지에 위치하는지에 따라 LFI(Local File Inclusion)과 RFI(Remote File Inclusion)으로 나누어진다. 

## 취약점
1. include 함수를 이용한 페이지
  * include 함수는 지정한 파일을 현재 페이지에 포함해 실행시켜주는 함수이다. 만약 파일/페이지 정보를 외부로부터 입력받을 때 적절한 검증을 수행하지 않으면 악성 스크립트를 포함한 페이지가 include되어 피해가 발생할 수 있다. 
2. RFI를 통한 웹쉘 실행
    * 공격자 서버에 있는 원격파일을 URL 파리미터에 포함시켜 전달하여 해당 파일이 include 되어 웹쉘이 실행된다. 

## 대응책
* 공격자에 의해 외부 사이트에 있는 악성 스크립트 파일이 URL 형태로 include되지 않도록 PHP 설정 파일인 php.ini 파일에서 allow_url_fopen을 Off로 설정한다. 
  * allow_url_fopen 기능은 PHP에서 include, require 등의 함수를 이용하여 외부 파일을 URL 형식으로 읽어올 수 있도록 해주는 기능으로 보안에 취약한 설정이기 때문에 허용하지 않는 것을 권장한다. 
* 관리자는 소스코드에 include, require 등의 구문/함수가 존재하는지 검증하고 만약 사용자의 입력값을 통해 파일명이 결정된다면 외부의 악의적인 파일이 포함되어 실행되지 않도록 PHP설정 파일인 php.ini 파일에서 allow_url_fopen을 Off로 설정한다. 
* 최근 발생하고 있는 대규모 홈페이지 변조는 PHP의 외부 사이트 소스 실행 기능을 이용하여 악의적인 스크립트를 로컬 서버에서 실행시켜 발생하고 있으므로 주의해야한다. 